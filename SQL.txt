SELECT
  c.customer_id,
  c.name,
  c.email,
  SUM(o.amount) AS total_spent
FROM customers AS c
JOIN orders AS o
  ON o.customer_id = c.customer_id
WHERE o.order_date >= CURDATE() - INTERVAL 1 YEAR
GROUP BY c.customer_id, c.name, c.email
ORDER BY total_spent DESC
LIMIT 5;